<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Diff Stripper</title>
<style>
  body { margin: 0; background: #1a1a1a; color: #e0e0e0; font-family: monospace; display: flex; flex-direction: column; height: 100vh; }
  h1 { font-size: 1rem; padding: 12px 16px; margin: 0; background: #2a2a2a; border-bottom: 1px solid #444; color: #00bcd4; }
  .panes { display: flex; flex: 1; gap: 0; overflow: hidden; }
  .pane { flex: 1; display: flex; flex-direction: column; }
  .pane + .pane { border-left: 1px solid #444; }
  label { font-size: 0.75rem; padding: 6px 12px; background: #222; color: #aaa; }
  textarea { flex: 1; background: #111; color: #e0e0e0; border: none; padding: 12px; font-family: monospace; font-size: 0.85rem; resize: none; outline: none; }
  #output { color: #a5d6a7; }
  .btn-row { display: flex; gap: 8px; padding: 10px 16px; background: #2a2a2a; border-top: 1px solid #444; }
  button { background: #00bcd4; color: #000; border: none; padding: 8px 18px; border-radius: 4px; cursor: pointer; font-size: 0.85rem; font-weight: bold; }
  button:hover { background: #00e5ff; }
  #copy-btn { background: #444; color: #fff; }
  #copy-btn:hover { background: #666; }
  #copy-btn.done { background: #4caf50; color: #fff; }
</style>
</head>
<body>
<h1>Diff Stripper — + / - 行頭記号を除去してコードに戻す</h1>
<div class="panes">
  <div class="pane">
    <label>▼ Diff を貼り付け</label>
    <textarea id="input" placeholder="+ some code&#10;+ more code&#10;- removed line&#10;  unchanged line"></textarea>
  </div>
  <div class="pane">
    <label>▼ 変換結果（+行のみ抽出）</label>
    <textarea id="output" readonly></textarea>
  </div>
</div>
<div class="btn-row">
  <button onclick="convert()">変換</button>
  <button id="copy-btn" onclick="copyOutput()">コピー</button>
  <label style="background:none; color:#666; font-size:0.75rem; align-self:center; padding:0;">
    ※ <code>+</code> で始まる行のみ抽出し、先頭の <code>+ </code> を除去します。<code>-</code> 行は削除。未変更行はそのまま残します。
  </label>
</div>
<script>
  const input = document.getElementById('input');
  const output = document.getElementById('output');

  // リアルタイム変換
  input.addEventListener('input', convert);

  function convert() {
    const lines = input.value.split('\n');
    const result = lines
      .filter(l => !l.startsWith('-'))       // - 行を除外
      .map(l => l.startsWith('+') ? l.slice(1).replace(/^ /, '') : l)  // + を除去
      .join('\n');
    output.value = result;
  }

  function copyOutput() {
    navigator.clipboard.writeText(output.value).then(() => {
      const btn = document.getElementById('copy-btn');
      btn.textContent = '✓ コピー完了';
      btn.classList.add('done');
      setTimeout(() => { btn.textContent = 'コピー'; btn.classList.remove('done'); }, 1500);
    });
  }
</script>
</body>
</html>
